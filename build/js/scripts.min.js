"use strict";var renderFilms=[],genres=[],pageNumber=1,list=document.querySelector(".cards__container");function createCardFunc(e){var t=e.backdrop_path,a=e.title,r=e.id,i=e.vote_average,n=document.createElement("li");n.className="card__container";var d=document.createElement("div");d.className="card__mark",d.innerHTML=0!==i?i:"--";var c=document.createElement("div");c.className="card__title",c.innerHTML=a;var l=document.createElement("img");l.className="card__img";var s=null!==t?"https://image.tmdb.org/t/p/w500/".concat(t):"https://image.tmdb.org/t/p/w500//gkuyOdCeuKLdOlwQIUF44SHsYCq.jpg";return l.setAttribute("src",s),l.setAttribute("alt",a),n.append(d,c,l),list.appendChild(n),n.addEventListener("click",function(){return activeDetailsPage(r,!1)}),n}function fetchPopularMoviesList(){var t=document.createDocumentFragment();fetch("https://api.themoviedb.org/3/movie/popular?api_key=56d683041d5d1a0178e72b4a2ffc8e86&language=en-US&page=".concat(pageNumber)).then(function(e){return e.json()}).then(function(e){return e.results}).then(function(e){e.map(function(e){renderFilms.push(e),t.append(createCardFunc(e))}),list.innerHTML="",list.append(t)})}function fetchGenres(){fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=56d683041d5d1a0178e72b4a2ffc8e86&language=en-US").then(function(e){return e.json()}).then(function(e){return e.genres}).then(function(e){e.map(function(e){genres.push(e)})})}fetchPopularMoviesList(),fetchGenres();var inputValue=document.querySelector(".card__search_input"),form=document.querySelector("#js-form"),error=document.querySelector(".error"),buttonBar=document.querySelector(".switching-bar_content"),buttonBarPrev=document.querySelector(".switching-bar_prev"),barSpan=document.querySelector(".switching-bar_span");function hundleSubmit(e){e.preventDefault(),searchFilms()}function searchFilms(){fetchFilms(inputValue.value,pageNumber).then(function(e){var t=document.createDocumentFragment();void 0!==e&&(e.map(function(e){renderFilms.push(e),t.append(createCardFunc(e))}),list.innerHTML="",list.append(t))})}function fetchFilms(e,t){return fetch("https://api.themoviedb.org/3/search/movie?api_key=56d683041d5d1a0178e72b4a2ffc8e86&language=en-US&page=".concat(t,"&query=").concat(e)).then(function(e){return e.json()}).then(function(e){if(0!==e.results.length)return error.innerHTML="",e.results;error.innerHTML="Nothing has been found :("})}function plaginationNavigation(e){"prev"===e.target.dataset.id&&1!==pageNumber&&(pageNumber-=1,1===(barSpan.innerHTML=pageNumber)&&e.target.classList.remove("switching-bar_btn__active")),"next"===e.target.dataset.id&&(pageNumber+=1,2===(barSpan.innerHTML=pageNumber)&&buttonBar.firstChild.classList.add("switching-bar_btn__active")),""===inputValue.value?fetchPopularMoviesList():searchFilms()}form.addEventListener("submit",hundleSubmit),buttonBar.addEventListener("click",plaginationNavigation);var homeBtn=document.querySelector(".nav__home"),myLibraryBtn=document.querySelector(".nav__library"),myLibrary=document.querySelector(".js-library-page"),detailsPage=document.querySelector(".js-details-page"),homePage=document.querySelector(".js-home-page"),headerLogo=document.querySelector(".header__logo"),card=document.querySelector(".card__container");function activeLibraryPage(){homePage.classList.add("visually-hidden"),myLibrary.classList.remove("visually-hidden"),detailsPage.classList.add("visually-hidden")}function activeHomePage(){homePage.classList.remove("visually-hidden"),myLibrary.classList.add("visually-hidden"),detailsPage.classList.add("visually-hidden")}function activeDetailsPage(e,t){homePage.classList.add("visually-hidden"),myLibrary.classList.add("visually-hidden"),detailsPage.classList.remove("visually-hidden"),renderDetailsPage(e,t)}homeBtn.addEventListener("click",activeHomePage),myLibraryBtn.addEventListener("click",activeLibraryPage),headerLogo.addEventListener("click",activeHomePage),activeHomePage();var hundleClickChangeWatched,hundleClickChangeQueue,detailsTitle=document.querySelector(".details__title"),detailsVote=document.querySelector(".content-table__col2__row1"),detailsPopularity=document.querySelector(".content-table__col2__row2"),detailsOriginalTitle=document.querySelector(".content-table__col2__row3"),detailsGenre=document.querySelector(".content-table__col2__row4"),detailsAbout=document.querySelector(".details_about"),btnAddWatched=document.querySelector(".btn-list-item-1"),btnAddQueue=document.querySelector(".btn-list-item-2"),detailsImg=document.querySelector(".img-wrapper");function renderDetailsPage(t,e){var a;e||(renderFilms.forEach(function(e){e.id===t&&(a=e)}),detailsTitle.innerHTML=a.title,detailsVote.innerHTML=a.vote_average,detailsPopularity.innerHTML=a.popularity,detailsOriginalTitle.innerHTML=a.original_title,detailsAbout.innerHTML=a.overview,detailsImg.firstChild.setAttribute("src","https://image.tmdb.org/t/p/w500/".concat(a.poster_path)));var r=localStorage.getItem("watched")?JSON.parse(localStorage.getItem("watched")):[];0===r.lenght?(btnAddWatched.firstChild.setAttribute("src","images/icon/video.png"),btnAddWatched.lastChild.innerHTML="Add to watched"):r.find(function(e){return e.id===t})?(btnAddWatched.lastChild.innerHTML="Remove from watched",btnAddWatched.firstChild.setAttribute("src","images/icon/trash.png")):(btnAddWatched.firstChild.setAttribute("src","images/icon/video.png"),btnAddWatched.lastChild.innerHTML="Add to watched"),hundleClickChangeWatched=function(e){"Add to watched"===e.target.innerHTML?(r.unshift(a),btnAddWatched.lastChild.innerHTML="Remove from watched",btnAddWatched.firstChild.setAttribute("src","images/icon/trash.png")):(r.pop(a),btnAddWatched.lastChild.innerHTML="Add to watched",btnAddWatched.firstChild.setAttribute("src","images/icon/video.png")),localStorage.setItem("watched",JSON.stringify(r))};var i=localStorage.getItem("queue")?JSON.parse(localStorage.getItem("queue")):[];0===i.lenght?(btnAddQueue.firstChild.setAttribute("src","images/icon/calendar-plus.png"),btnAddQueue.lastChild.innerHTML="Add to queue"):i.find(function(e){return e.id===t})?(btnAddQueue.lastChild.innerHTML="Remove from queue",btnAddQueue.firstChild.setAttribute("src","images/icon/calendar-minus.png")):(btnAddQueue.firstChild.setAttribute("src","images/icon/calendar-plus.png"),btnAddQueue.lastChild.innerHTML="Add to queue"),hundleClickChangeQueue=function(e){"Add to queue"===e.target.innerHTML?(i.unshift(a),e.target.innerHTML="Remove from queue",btnAddQueue.firstChild.setAttribute("src","images/icon/calendar-minus.png")):(i.pop(a),e.target.innerHTML="Add to queue",btnAddQueue.firstChild.setAttribute("src","images/icon/calendar-plus.png")),localStorage.setItem("queue",JSON.stringify(i))}}btnAddWatched.addEventListener("click",function(e){return hundleClickChangeWatched(e)}),btnAddQueue.addEventListener("click",function(e){return hundleClickChangeQueue(e)});var libraryCards=document.querySelector(".cards__wrapper"),createCardLibrary=function(e){var t=e.backdrop_path,a=e.title,r=e.id,i=e.vote_average,n=document.createElement("li");n.className="card__container";var d=document.createElement("div");d.className="card__mark",d.innerHTML=0!==i?i:"--";var c=document.createElement("div");c.className="card__title",c.innerHTML=a;var l=document.createElement("img");l.className="card__img";var s=null!==t?"https://image.tmdb.org/t/p/w500/".concat(t):"https://image.tmdb.org/t/p/w500//gkuyOdCeuKLdOlwQIUF44SHsYCq.jpg";l.setAttribute("src",s),l.setAttribute("alt",a),n.append(d,c,l),libraryCards.appendChild(n),n.addEventListener("click",function(){return activeDetailsPage(r,!1)})},librarySpinWatchd=document.querySelector(".library__spin__list-item-watched"),librarySpinQueue=document.querySelector(".library__spin__list-item-queue"),libraryCardsWatched=localStorage.getItem("watched")?JSON.parse(localStorage.getItem("watched")):[];0==libraryCardsWatched.length?libraryCards.innerHTML="Your movies for watching will be here ":libraryCardsWatched.forEach(function(e){createCardLibrary(e)}),librarySpinWatchd.addEventListener("click",function(){0===(libraryCardsWatched=localStorage.getItem("watched")?JSON.parse(localStorage.getItem("watched")):[]).length?libraryCards.innerHTML="Your movies for watching will be here ":(libraryCards.innerHTML="",libraryCardsWatched.forEach(function(e){createCardLibrary(e)})),librarySpinWatchd.classList.add("library__spin__list-item-active"),librarySpinQueue.classList.remove("library__spin__list-item-active")}),librarySpinQueue.addEventListener("click",function(){var e=localStorage.getItem("queue")?JSON.parse(localStorage.getItem("queue")):[];0===e.length?libraryCards.innerHTML="Your movies in queue will be here":(libraryCards.innerHTML="",e.forEach(function(e){createCardLibrary(e)})),librarySpinQueue.classList.add("library__spin__list-item-active"),librarySpinWatchd.classList.remove("library__spin__list-item-active")});